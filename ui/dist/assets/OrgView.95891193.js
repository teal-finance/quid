import{m as b,d as w,o as c,f as _,w as p,b as r,u as s,l as h,n as m,j as k,k as C,c as $,S as A,a as l,i as x,y as V,I as y,p as B,F as D}from"./index.f6d5cb7b.js";import{s as g,A as E,a as N}from"./ActionButton.e9a221e4.js";class v{constructor(t){this.id=t.id,this.name=t.name}toTableRow(){const t=Object.create(this);return t.actions=[],t}static async fetchAll(){const t="/admin/orgs/all",e=new Array;try{(await b.get(t)).forEach(i=>e.push(new v(i).toTableRow()))}catch(a){throw console.log("Err",a),a}return e}static async delete(t){await b.post("/admin/orgs/delete",{id:t})}}const O=h("Delete"),F=w({props:{orgs:{type:Array,required:!0}},emits:["reload"],setup(f,{emit:t}){function e(a){m.confirmDelete(`Delete the ${a.name} org?`,()=>{v.delete(a.id).then(()=>{m.done("Org deleted"),t("reload")})})}return(a,i)=>(c(),_(s(N),{value:f.orgs,class:"p-datatable-sm main-table","data-key":"id"},{default:p(()=>[r(s(g),{field:"id",header:"Id"}),r(s(g),{field:"name",header:"Name"}),r(s(g),{field:"actions"},{body:p(u=>[r(E,{type:"delete",class:"ml-2",onClick:n=>e(u.data)},{default:p(()=>[O]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["value"]))}}),I={class:"flex flex-col space-y-5"},q={class:"flex flex-row"},R=["disabled"],S=w({emits:["end"],setup(f,{emit:t}){const e=k({name:{val:"",isValid:null,validator:n=>n.length>=3}}),a=C(()=>e.name.isValid===!0);function i(){t("end")}async function u(){try{await b.post("/admin/orgs/add",{name:e.name.val}),t("end"),m.done("Org added")}catch(n){console.log(n),m.error("Error creating org")}}return(n,o)=>(c(),$("div",I,[r(s(A),{value:s(e).name.val,"onUpdate:value":o[0]||(o[0]=d=>s(e).name.val=d),isvalid:s(e).name.isValid,"onUpdate:isvalid":o[1]||(o[1]=d=>s(e).name.isValid=d),validator:s(e).name.validator,"inline-label":"Name",required:"",autofocus:""},null,8,["value","isvalid","validator"]),l("div",q,[l("button",{class:"w-20 mr-3 btn success",disabled:!s(a),onClick:o[2]||(o[2]=d=>u())},"Save",8,R),l("button",{class:"w-20 btn warning",onClick:o[3]||(o[3]=d=>i())},"Cancel")])]))}}),T={class:"text-3xl txt-primary dark:txt-light"},j=h(" Orgs "),U={class:"p-5 mt-3 border bord-lighter w-96"},z=l("div",{class:"text-xl"},"Add an org",-1),H=w({setup(f){const t=x([]),e=x(!0);async function a(){t.value=await v.fetchAll()}function i(){e.value=!0,a()}return V(()=>a()),(u,n)=>(c(),$(D,null,[l("div",T,[j,l("button",{class:"ml-3 text-2xl border-none btn focus:outline-none txt-neutral",onClick:n[0]||(n[0]=o=>e.value=!e.value)},[e.value===!0?(c(),_(s(y),{key:0,icon:"fa6-solid:plus"})):(c(),_(s(y),{key:1,icon:"fa6-solid:minus"}))])]),l("div",{class:B([{"slide-y":!0,slideup:e.value===!0,slidedown:e.value===!1},"mb-8"])},[l("div",U,[z,r(S,{class:"mt-5",onEnd:n[1]||(n[1]=o=>i())})])],2),r(F,{orgs:t.value,onReload:n[2]||(n[2]=o=>a())},null,8,["orgs"])],64))}});export{H as default};
