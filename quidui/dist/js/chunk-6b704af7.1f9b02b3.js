(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b704af7"],{3943:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",{staticClass:"text-muted mt-3"},[e._v(" GroupsÂ  "),"addGroup"!==e.action?a("b-icon-plus",{staticClass:"mr-1",staticStyle:{color:"lightgrey"},on:{click:function(t){return e.$store.commit("action","addGroup")}}}):e._e()],1),e.state.isLoading?a("loading-indicator"):e._e(),a("div",[a("b-collapse",{staticClass:"mt-2",attrs:{id:"collapse-4"},model:{value:e.showActionBar,callback:function(t){e.showActionBar=t},expression:"showActionBar"}},["addGroup"===e.action?a("groups-add",{on:{refresh:e.refresh}}):e._e()],1)],1),a("b-table",{staticClass:"mt-4",staticStyle:{"max-width":"650px"},attrs:{hover:"",bordeless:"",items:e.data,fields:e.fields},scopedSlots:e._u([{key:"cell(action)",fn:function(t){return[a("b-button",{staticClass:"mr-2",attrs:{variant:"outline-secondary"},on:{click:function(a){return e.toggleDetails(t)}}},[e._v(e._s(t.detailsShowing?"Hide":"Show")+" users")]),"quid_admin"!==t.item.name?a("b-button",{attrs:{variant:"outline-danger"},on:{click:function(a){return e.confirmDeleteItem(t.item.id,t.item.name)}}},[e._v("Delete")]):e._e()]}},{key:"row-details",fn:function(t){return[void 0!=e.rowDetails[t.index]?a("groups-info",{attrs:{details:e.rowDetails[t.index]}}):e._e()]}}])}),a("b-modal",{ref:"delete-modal",attrs:{title:"Delete group"},scopedSlots:e._u([{key:"modal-footer",fn:function(t){return[a("b-button",{attrs:{variant:"danger"},on:{click:function(t){return e.deleteItem(e.itemToDelete)}}},[e._v("Delete")]),a("b-button",{attrs:{variant:"warning"},on:{click:function(e){return t.cancel()}}},[e._v("Cancel")])]}}])},[e._v(" Delete "+e._s(e.itemToDelete.name)+"? ")])],1)},s=[],i=a("5530"),r=a("1da1"),o=(a("96cf"),a("2f62")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-form",[a("b-card",{staticClass:"mb-2",staticStyle:{"max-width":"28rem"},attrs:{title:"Add a group"}},[a("b-card-text",[a("namespace-select",{on:{validate:e.validateNamespace,unvalidate:e.unvalidateNamespace}}),a("b-form-group",[a("b-form-input",{attrs:{state:e.isValidName,placeholder:"name"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),a("b-form-invalid-feedback",{attrs:{state:e.isValidName}},[e._v("The name must be at least 4 characters long")])],1)],1),e.isValidForm?a("b-button",{attrs:{variant:"success"},on:{click:e.postForm}},[e._v("Save")]):a("b-button",{attrs:{variant:"success",disabled:""}},[e._v("Save")]),a("b-button",{staticClass:"ml-2",attrs:{variant:"warning"},on:{click:function(t){return e.$store.commit("endAction")}}},[e._v("Cancel")])],1)],1)},l=[],u=(a("b0c0"),a("c586")),d={components:{NamespaceSelect:u["a"]},data:function(){return{form:{name:"",namespace:null},isNamespaceValid:!1}},methods:{unvalidateNamespace:function(){this.isNamespaceValid=!1},validateNamespace:function(e){this.form.namespace=e,this.isNamespaceValid=!0},postForm:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.post("/admin/groups/add",{name:e.form.name,namespace_id:e.form.namespace.id});case 2:a=t.sent,n=a.error,null==n?(e.form.name="",e.form.namespace=null,e.$emit("refresh"),e.$store.commit("endAction")):409===n.reponse.status&&(e.form.name="",e.form.namespace=null);case 5:case"end":return t.stop()}}),t)})))()}},computed:{isValidForm:function(){return this.isValidName&&this.isNamespaceValid},isValidName:function(){return 0===this.form.name.length?null:this.form.name.length>=4}}},m=d,f=a("2877"),p=Object(f["a"])(m,c,l,!1,null,null,null),h=p.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-card",[a("b-row",{staticClass:"mb-2"},[a("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[a("b",[e._v("Users")])]),a("b-col",[e._v(e._s(e.details.num_users))])],1)],1)},v=[],g={props:{details:{type:Object,default:function(){}}}},w=g,_=Object(f["a"])(w,b,v,!1,null,null,null),x=_.exports,k=a("b758"),y={components:{GroupsAdd:h,GroupsInfo:x,LoadingIndicator:k["a"]},data:function(){return{data:[],state:{isLoading:!1},fields:[{key:"id",sortable:!0},{key:"name",sortable:!0},{key:"namespace",sortable:!0},{key:"action",sortable:!1}],itemToDelete:{},rowDetails:{}}},methods:{getRowDetails:function(e){return e.detailsShowing||void 0===this.rowDetails[e.index]?{users:null}:this.rowDetails[e.index]},toggleDetails:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.detailsShowing){a.next=6;break}return a.next=3,t.$api.post("/admin/groups/info",{id:e.item.id});case 3:n=a.sent,s=n.response,t.rowDetails[e.index]=s.data;case 6:e.toggleDetails();case 7:case"end":return a.stop()}}),a)})))()},refresh:function(){this.fetchGroups(),this.$bvToast.toast("ok",{title:"Group saved",variant:"success",autoHideDelay:1500})},fetchGroups:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.state.isLoading=!0,t.next=3,e.$api.get("/admin/groups/all");case 3:a=t.sent,n=a.response,e.data=n.data,e.state.isLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},confirmDeleteItem:function(e,t){this.itemToDelete={name:t,id:e},this.$refs["delete-modal"].show()},deleteItem:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.$refs["delete-modal"].hide(),a.next=3,t.$api.post("/admin/groups/delete",{id:e.id});case 3:n=a.sent,s=n.error,null===s&&(t.$bvToast.toast("Ok",{title:"Group deleted",autoHideDelay:1e3,variant:"success"}),t.fetchGroups());case 6:case"end":return a.stop()}}),a)})))()}},mounted:function(){this.fetchGroups()},computed:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(o["c"])(["action"])),Object(o["b"])({s:"showActionBar"})),{},{showActionBar:{get:function(){return this.s},set:function(e){return e}}})},D=y,$=Object(f["a"])(D,n,s,!1,null,null,null);t["default"]=$.exports},b0c0:function(e,t,a){var n=a("83ab"),s=a("5e77").EXISTS,i=a("e330"),r=a("9bf2").f,o=Function.prototype,c=i(o.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=i(l.exec),d="name";n&&!s&&r(o,d,{configurable:!0,get:function(){try{return u(l,c(this))[1]}catch(e){return""}}})},b758:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"text-center mt-5",staticStyle:{color:"lightgrey"}},[a("b-icon",{staticClass:"h1",attrs:{icon:"three-dots",animation:"cylon"}})],1)},s=[],i=a("2877"),r={},o=Object(i["a"])(r,n,s,!1,null,null,null);t["a"]=o.exports},c586:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-form-group",[a("b-form-input",{attrs:{debounce:"500",state:e.isValid,placeholder:"namespace"},on:{change:e.onChange,update:e.fetchNamespaces},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),a("div",{staticClass:"mt-2"},[e.state.isLoading?a("b-icon",{attrs:{icon:"three-dots",animation:"cylon"}}):e._e(),e._l(e.items,(function(t){return a("b-badge",{key:t.id,staticClass:"mr-2",attrs:{variant:"primary"},on:{click:function(a){return e.select(t)}}},[e._v(e._s(t.name))])}))],2)],1)},s=[],i=a("1da1"),r=(a("b0c0"),a("96cf"),{data:function(){return{value:"",items:[],selected:null,state:{isLoading:!1,isFormValid:!1}}},methods:{fetchNamespaces:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.state.isFormValid=!1,e.$emit("unvalidate"),""!==e.value){t.next=5;break}return e.items=[],t.abrupt("return");case 5:return e.state.isLoading=!0,t.next=8,e.$api.post("/admin/namespaces/find",{name:e.value});case 8:a=t.sent,n=a.response,s=a.error,e.state.isLoading=!1,null===s&&(e.items=n.data);case 13:case"end":return t.stop()}}),t)})))()},select:function(e){this.value=e.name,this.selected=e,this.state.isFormValid=!0,this.$emit("validate",this.selected),this.items=[]},onChange:function(){this.selected=null,this.$emit("unvalidate")}},computed:{isValid:function(){return""===this.value?null:null!==this.selected&&this.state.isFormValid}}}),o=r,c=a("2877"),l=Object(c["a"])(o,n,s,!1,null,null,null);t["a"]=l.exports}}]);
//# sourceMappingURL=chunk-6b704af7.1f9b02b3.js.map