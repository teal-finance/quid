import{z as _,d as w,o as c,f as b,w as p,u as o,b as r,B as h,A as m,x as k,y as A,c as $,S as C,a as l,j as x,J as V,I as y,p as O,F as B}from"./index-9874cade.js";import{s as D,a as g,A as E}from"./ActionButton-96ff89d5.js";class v{constructor(t){this.id=t.id,this.name=t.name}toTableRow(){const t=Object.create(this);return t.actions=[],t}static async fetchAll(){const t="/admin/orgs/all",e=new Array;try{(await _.get(t)).forEach(i=>e.push(new v(i).toTableRow()))}catch(a){throw console.log("Err",a),a}return e}static async delete(t){await _.post("/admin/orgs/delete",{id:t})}}const N=h("Delete"),F=w({__name:"OrgDatatable",props:{orgs:{type:Array,required:!0}},emits:["reload"],setup(f,{emit:t}){function e(a){m.confirmDelete(`Delete the ${a.name} org?`,()=>{v.delete(a.id).then(()=>{m.done("Org deleted"),t("reload")})})}return(a,i)=>(c(),b(o(D),{value:f.orgs,class:"p-datatable-sm main-table","data-key":"id"},{default:p(()=>[r(o(g),{field:"id",header:"Id"}),r(o(g),{field:"name",header:"Name"}),r(o(g),{field:"actions"},{body:p(u=>[r(E,{type:"delete",class:"ml-2",onClick:s=>e(u.data)},{default:p(()=>[N]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["value"]))}}),I={class:"flex flex-col space-y-5"},q={class:"flex flex-row"},R=["disabled"],S=w({__name:"AddOrg",emits:["end"],setup(f,{emit:t}){const e=k({name:{val:"",isValid:null,validator:s=>s.length>=3}}),a=A(()=>e.name.isValid===!0);function i(){t("end")}async function u(){try{await _.post("/admin/orgs/add",{name:e.name.val}),t("end"),m.done("Org added")}catch(s){console.log(s),m.error("Error creating org")}}return(s,n)=>(c(),$("div",I,[r(o(C),{value:e.name.val,"onUpdate:value":n[0]||(n[0]=d=>e.name.val=d),isvalid:e.name.isValid,"onUpdate:isvalid":n[1]||(n[1]=d=>e.name.isValid=d),validator:e.name.validator,"inline-label":"Name",required:"",autofocus:""},null,8,["value","isvalid","validator"]),l("div",q,[l("button",{class:"w-20 mr-3 btn success",disabled:!o(a),onClick:n[2]||(n[2]=d=>u())},"Save",8,R),l("button",{class:"w-20 btn warning",onClick:n[3]||(n[3]=d=>i())},"Cancel")])]))}}),T={class:"text-3xl txt-primary dark:txt-light"},j=h(" Orgs "),z={class:"p-5 mt-3 border bord-lighter w-96"},U=l("div",{class:"text-xl"},"Add an org",-1),G=w({__name:"OrgView",setup(f){const t=x([]),e=x(!0);async function a(){t.value=await v.fetchAll()}function i(){e.value=!0,a()}return V(()=>a()),(u,s)=>(c(),$(B,null,[l("div",T,[j,l("button",{class:"ml-3 text-2xl border-none btn focus:outline-none txt-neutral",onClick:s[0]||(s[0]=n=>e.value=!e.value)},[e.value===!0?(c(),b(o(y),{key:0,icon:"fa6-solid:plus"})):(c(),b(o(y),{key:1,icon:"fa6-solid:minus"}))])]),l("div",{class:O([{"slide-y":!0,slideup:e.value===!0,slidedown:e.value===!1},"mb-8"])},[l("div",z,[U,r(S,{class:"mt-5",onEnd:s[1]||(s[1]=n=>i())})])],2),r(F,{orgs:t.value,onReload:s[2]||(s[2]=n=>a())},null,8,["orgs"])],64))}});export{G as default};
