import{d as g,i as b,o as l,c,b as d,w as _,u as t,l as $,n as f,a3 as C,j as N,k as S,S as V,a as i,m as A,v as u,y as h,f as v,I as w,s as y,p as B,F as G}from"./index.f6d5cb7b.js";import{_ as R}from"./NamespaceSelector.dd481d56.js";import{s as k,A as D,a as F}from"./ActionButton.e9a221e4.js";import"./SimpleBadge.0845ed75.js";const I=$("Delete"),q=g({props:{groups:{type:Array,required:!0}},emits:["reload"],setup(x,{emit:n}){const a=b([]);function m(o){f.confirmDelete(`Delete the ${o.name} group?`,()=>{C.delete(o.id).then(()=>{f.done("Group deleted"),n("reload")})})}return(o,r)=>(l(),c("div",null,[d(t(F),{value:x.groups,class:"main-table p-datatable-sm",expandedRows:a.value,"onUpdate:expandedRows":r[0]||(r[0]=e=>a.value=e),"data-key":"id"},{default:_(()=>[d(t(k),{field:"id",header:"Id"}),d(t(k),{field:"name",header:"Name"}),d(t(k),{field:"actions"},{body:_(e=>[d(D,{type:"delete",class:"ml-2",onClick:s=>m(e.data)},{default:_(()=>[I]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["value","expandedRows"])]))}}),E={class:"flex flex-col space-y-5"},U={class:"flex flex-row"},j=["disabled"],z=g({emits:["end"],setup(x,{emit:n}){const a=N({name:{val:"",isValid:null,validator:e=>e.length>=3}}),m=S(()=>a.name.isValid===!0);function o(){n("end")}async function r(){try{await A.post("/admin/groups/add",{name:a.name.val,namespace_id:u.namespace.value.id}),n("end"),f.done("Group added")}catch(e){console.log(e),f.error("Error creating group")}}return(e,s)=>(l(),c("div",E,[d(t(V),{value:t(a).name.val,"onUpdate:value":s[0]||(s[0]=p=>t(a).name.val=p),isvalid:t(a).name.isValid,"onUpdate:isvalid":s[1]||(s[1]=p=>t(a).name.isValid=p),validator:t(a).name.validator,"inline-label":"Name",required:"",autofocus:""},null,8,["value","isvalid","validator"]),i("div",U,[i("button",{class:"w-20 mr-3 btn success",disabled:!t(m),onClick:s[2]||(s[2]=p=>r())},"Save",8,j),i("button",{class:"w-20 btn warning",onClick:s[3]||(s[3]=p=>o())},"Cancel")])]))}}),M={class:"text-3xl txt-primary dark:txt-light"},T=$(" Groups "),H={class:"p-5 mt-3 border bord-lighter w-96"},J=i("div",{class:"text-xl"},"Add a group",-1),K={key:1,class:"w-full"},L=i("div",{class:"mt-3 text-2xl"},"Select a namespace",-1),X=g({setup(x){const n=b(!0),a=b([]);function m(){n.value=!0,o()}async function o(){const r=await C.fetchAll(u.namespace.value.id);a.value=Array.from(r)}return h(()=>{u.mustSelectNamespace||o()}),(r,e)=>(l(),c(G,null,[i("div",M,[T,t(u).mustSelectNamespace?y("",!0):(l(),c("button",{key:0,class:"ml-3 text-2xl border-none btn focus:outline-none txt-neutral",onClick:e[0]||(e[0]=s=>n.value=!n.value)},[n.value===!0?(l(),v(t(w),{key:0,icon:"fa6-solid:plus"})):(l(),v(t(w),{key:1,icon:"fa6-solid:minus"}))]))]),t(u).mustSelectNamespace?(l(),c("div",K,[L,d(R,{class:"mt-5",onSelectns:e[2]||(e[2]=s=>o())})])):(l(),c("div",{key:0,class:B([{"slide-y":!0,slideup:n.value===!0,slidedown:n.value===!1},"mb-8"])},[i("div",H,[J,n.value===!1?(l(),v(z,{key:0,class:"mt-5",onEnd:e[1]||(e[1]=s=>m())})):y("",!0)])],2)),t(u).mustSelectNamespace?y("",!0):(l(),v(q,{key:2,groups:a.value,onReload:e[3]||(e[3]=s=>o())},null,8,["groups"]))],64))}});export{X as default};
