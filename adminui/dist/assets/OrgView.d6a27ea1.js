var C=Object.defineProperty;var A=(l,e,t)=>e in l?C(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var p=(l,e,t)=>(A(l,typeof e!="symbol"?e+"":e,t),t);import{r as x,n as f}from"./index.3f7e8321.js";import{d as w,o as u,c as _,w as g,f as i,u as s,q as $,l as V,m as B,b as k,k as D,a as r,x as y,L as E,I as h,n as N,F as O}from"./vendor.ef2cb0e3.js";import{s as b,A as q,a as F}from"./ActionButton.c40b50fa.js";class v{constructor(e){p(this,"id");p(this,"name");this.id=e.id,this.name=e.name}toTableRow(){const e=Object.create(this);return e.actions=[],e}static async fetchAll(){const e="/admin/orgs/all",t=new Array;try{(await x.get(e)).forEach(d=>t.push(new v(d).toTableRow()))}catch(a){throw console.log("Err",a),a}return t}static async delete(e){await x.post("/admin/orgs/delete",{id:e})}}const I=$("Delete"),R=w({props:{orgs:{type:Array,required:!0}},emits:["reload"],setup(l,{emit:e}){function t(a){f.confirmDelete(`Delete the ${a.name} org?`,()=>{v.delete(a.id).then(()=>{f.done("Org deleted"),e("reload")})})}return(a,d)=>(u(),_(s(F),{value:l.orgs,class:"p-datatable-sm main-table","data-key":"id"},{default:g(()=>[i(s(b),{field:"id",header:"Id"}),i(s(b),{field:"name",header:"Name"}),i(s(b),{field:"actions"},{body:g(m=>[i(q,{type:"delete",class:"ml-2",onClick:n=>t(m.data)},{default:g(()=>[I]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["value"]))}}),T={class:"flex flex-col space-y-5"},S={class:"flex flex-row"},U=["disabled"],j=w({emits:["end"],setup(l,{emit:e}){const t=V({name:{val:"",isValid:null,validator:n=>n.length>=3}}),a=B(()=>t.name.isValid===!0);function d(){e("end")}async function m(){try{await x.post("/admin/orgs/add",{name:t.name.val}),e("end"),f.done("Org added")}catch(n){console.log(n),f.error("Error creating org")}}return(n,o)=>(u(),k("div",T,[i(s(D),{value:s(t).name.val,"onUpdate:value":o[0]||(o[0]=c=>s(t).name.val=c),isvalid:s(t).name.isValid,"onUpdate:isvalid":o[1]||(o[1]=c=>s(t).name.isValid=c),validator:s(t).name.validator,"inline-label":"Name",required:"",autofocus:""},null,8,["value","isvalid","validator"]),r("div",S,[r("button",{class:"w-20 mr-3 btn success",disabled:!s(a),onClick:o[2]||(o[2]=c=>m())},"Save",8,U),r("button",{class:"w-20 btn warning",onClick:o[3]||(o[3]=c=>d())},"Cancel")])]))}}),z={class:"text-3xl txt-primary dark:txt-light"},L=$(" Orgs "),M={class:"p-5 mt-3 border bord-lighter w-96"},G=r("div",{class:"text-xl"},"Add an org",-1),Q=w({setup(l){const e=y([]),t=y(!0);async function a(){e.value=await v.fetchAll()}function d(){t.value=!0,a()}return E(()=>a()),(m,n)=>(u(),k(O,null,[r("div",z,[L,r("button",{class:"ml-3 text-2xl border-none btn focus:outline-none txt-neutral",onClick:n[0]||(n[0]=o=>t.value=!t.value)},[t.value===!0?(u(),_(s(h),{key:0,icon:"fa6-solid:plus"})):(u(),_(s(h),{key:1,icon:"fa6-solid:minus"}))])]),r("div",{class:N([{"slide-y":!0,slideup:t.value===!0,slidedown:t.value===!1},"mb-8"])},[r("div",M,[G,i(j,{class:"mt-5",onEnd:n[1]||(n[1]=o=>d())})])],2),i(R,{orgs:e.value,onReload:n[2]||(n[2]=o=>a())},null,8,["orgs"])],64))}});export{Q as default};
