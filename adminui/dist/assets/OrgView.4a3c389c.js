var C=Object.defineProperty;var A=(l,e,t)=>e in l?C(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var p=(l,e,t)=>(A(l,typeof e!="symbol"?e+"":e,t),t);import{m as _,d as x,o as u,f as w,w as g,b as i,u as s,l as $,n as f,j as V,k as B,c as k,S as D,a as r,i as y,y as E,I as h,p as N,F as O}from"./index.688ec64a.js";import{s as b,A as F,a as I}from"./ActionButton.e351381e.js";class v{constructor(e){p(this,"id");p(this,"name");this.id=e.id,this.name=e.name}toTableRow(){const e=Object.create(this);return e.actions=[],e}static async fetchAll(){const e="/admin/orgs/all",t=new Array;try{(await _.get(e)).forEach(d=>t.push(new v(d).toTableRow()))}catch(a){throw console.log("Err",a),a}return t}static async delete(e){await _.post("/admin/orgs/delete",{id:e})}}const q=$("Delete"),R=x({props:{orgs:{type:Array,required:!0}},emits:["reload"],setup(l,{emit:e}){function t(a){f.confirmDelete(`Delete the ${a.name} org?`,()=>{v.delete(a.id).then(()=>{f.done("Org deleted"),e("reload")})})}return(a,d)=>(u(),w(s(I),{value:l.orgs,class:"p-datatable-sm main-table","data-key":"id"},{default:g(()=>[i(s(b),{field:"id",header:"Id"}),i(s(b),{field:"name",header:"Name"}),i(s(b),{field:"actions"},{body:g(m=>[i(F,{type:"delete",class:"ml-2",onClick:n=>t(m.data)},{default:g(()=>[q]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["value"]))}}),S={class:"flex flex-col space-y-5"},T={class:"flex flex-row"},j=["disabled"],U=x({emits:["end"],setup(l,{emit:e}){const t=V({name:{val:"",isValid:null,validator:n=>n.length>=3}}),a=B(()=>t.name.isValid===!0);function d(){e("end")}async function m(){try{await _.post("/admin/orgs/add",{name:t.name.val}),e("end"),f.done("Org added")}catch(n){console.log(n),f.error("Error creating org")}}return(n,o)=>(u(),k("div",S,[i(s(D),{value:s(t).name.val,"onUpdate:value":o[0]||(o[0]=c=>s(t).name.val=c),isvalid:s(t).name.isValid,"onUpdate:isvalid":o[1]||(o[1]=c=>s(t).name.isValid=c),validator:s(t).name.validator,"inline-label":"Name",required:"",autofocus:""},null,8,["value","isvalid","validator"]),r("div",T,[r("button",{class:"w-20 mr-3 btn success",disabled:!s(a),onClick:o[2]||(o[2]=c=>m())},"Save",8,j),r("button",{class:"w-20 btn warning",onClick:o[3]||(o[3]=c=>d())},"Cancel")])]))}}),z={class:"text-3xl txt-primary dark:txt-light"},M=$(" Orgs "),G={class:"p-5 mt-3 border bord-lighter w-96"},H=r("div",{class:"text-xl"},"Add an org",-1),P=x({setup(l){const e=y([]),t=y(!0);async function a(){e.value=await v.fetchAll()}function d(){t.value=!0,a()}return E(()=>a()),(m,n)=>(u(),k(O,null,[r("div",z,[M,r("button",{class:"ml-3 text-2xl border-none btn focus:outline-none txt-neutral",onClick:n[0]||(n[0]=o=>t.value=!t.value)},[t.value===!0?(u(),w(s(h),{key:0,icon:"fa6-solid:plus"})):(u(),w(s(h),{key:1,icon:"fa6-solid:minus"}))])]),r("div",{class:N([{"slide-y":!0,slideup:t.value===!0,slidedown:t.value===!1},"mb-8"])},[r("div",G,[H,i(U,{class:"mt-5",onEnd:n[1]||(n[1]=o=>d())})])],2),i(R,{orgs:e.value,onReload:n[2]||(n[2]=o=>a())},null,8,["orgs"])],64))}});export{P as default};
